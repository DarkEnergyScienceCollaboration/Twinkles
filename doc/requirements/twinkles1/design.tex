% ====================================================================
\section{Dataset Design}
\label{sec:twinkles1:design}
% ====================================================================

\contact{Phil Marshall}{@drphilmarshall}
\contact{Michael Wood-Vasey}{@wmwv}

% --------------------------------------------------------------------


\subsection{Targets}

Requirement. SN. 
Over 100 supernovae with expected $>5$ observations at SNR$>5$ during simulated period.
Another 100 or greater supernovae that are fainter and trace down into the SNR$<1$ regime.
Supernova to be distributed on hosts following surface brightness of hosts. Use native \CatSim
galaxies as hosts -- this dictates the redshifts of the SNe. Maximum redshift should be 1.2, so that input catalog is dominated by SNe we expect to see. Use SNRealizer to draw SNe.
Validation: Plot instance catalog magnitude and redshift distributions.
Validation: Plot sky positions (RA, Dec) of simulated transients.
Validation: [Post-pixel] Inspect postage stamp image sets. 

Requirement. SL.
At least 200 strongly lensed quasars from TDC1. Quasars to lie at correct source redshift (ie on suitable, or replaced, \CatSim host galaxies), and with massive elliptical 
lens galaxies at correct redshifts placed in front of them. Quasar light curves to follow TDC2 multi-filter model, with time delay correctly included. Use each source galaxy position at most once. 
Validation: [Post-pixel] Inspect postage stamp image composites, compare with input truth.
Validation: [Post-pixel] Inspect sky positions plotted on full field images. 
Validation: Plot sky positions (RA, Dec) of simulated transients.

Requirement: Area. 
Observable field should fit inside one chip, in presence of small dithers and field rotation. Circle of radius 6.6 arcmin, area 136 square arcmin. 
Validation: Inspect co-add composite image and check sky coverage. Overlay \CatSim reference catalog. 

Requirement. Stars and Galaxies.
Standard \CatSim distribution of stars and galaxies for the the chosen field, to enable standard DM processing of the field (including calibration and PSF modeling) as well as various validation tests. 
Validation: Plot \CatSim reference catalog sky positions, labeling stars, galaxies, SL, SN.   Also create overlays of instance catalog position to visualize verify mean positions.

Requirement. Pointing. 
Within a deep drilling field. Remove stars with $r < 16$ to ease image generation and processing.
Validation: [Post-pixel] Check FITS file headers, display visit images in ds9.  

Refer to \autoref{sec:twinkles1:science:supernovae}.
and \autoref{sec:twinkles1:science:stronglensing}.



% --------------------------------------------------------------------

\subsection{Observations}

Requirement. Cadence and Exposure Time.
Survey strategy (cadence, season, campaign). Oversampling.
Cadence should follow something like a deep-drilling field cadence.  Will use a suitable Enigma 1189 DDF.
Follow for 3 seasons.
Validation: Visualize time sampling.  Check that both DDF and WDF components are included and sensible for chosen field.

Requirement.  Filters. 
Use full complement of LSST filters following OpSim Enigma 1189.
Validation: Visualize time sampling per filter and total visits / filter for each of (total, DDF, and WFD).

Requirement.  Dithers and Field Rotation.
Small dithers (10") and realistic field rotation (e.g., uniform 0..$\pi$ {\bf [ASK WL for preferred distribution]}). 
Validation: Visualize distribution of dithers; and of field rotation.

Requirement:  Observing conditions.
No clouds.  Default wind+atm models from PhoSim.
Validate: Inspect input files.
Validation: {\bf ???}  Post-pixel: Check for outliers in calibration plots.  


% --------------------------------------------------------------------
Requirement.  Detector effects.
Turn off detector effects that are currently unmodeled by DM:
  Edge rolloff, midline charge stop, brighter-fatter, pointing errors, tree rings
Validate: Inspect input files.
Validate: [Post-pixel].  TBD.

Leave on:\\
saturation/blooming, charge diffusion, vignetting \\
Validate: [Post-pixel] Look for saturation visually.
Validate: [Post-pixel].  TBD.

Requirement. Sky Background.
Sky brightness should agree with OpSim and have time-coherent background variations consistent with observed distributions.
Validate: [Post-pixel] Measure sky in generated image.  Compare PhoSim 5-sigma depth with OpSim 5-sigma depth.

Requirement. PSF.
PSF should agree with OpSim.
Validate: [Post-pixel]  Measure PSF FWHM.  Compare with OpSim input.

% ====================================================================
